steps:
  S_EFF_AGENTFORECAST-7777512c-62c7-4d25-9783-bf7a2e436c39:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: STAGE
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 337aeff9-8ac0-4700-8a2e-7974148c725c
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: EVENT_DT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3b5ab9d8-45cb-48b0-a6f1-96dbbd115532
                    stepCounter: 1822377e-5830-4840-b644-27f44f05ca98
                transform: TO_DATE(L_BCS_RPLAN.C_FCSTPRD)
          - columnReference:
              columnCounter: c11816fa-babf-41f1-b4e4-4e3530bbc391
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(38,0)
            description: Dummy
            hashColumns: []
            hashDetails: null
            name: D_AGENT_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "-1"
          - columnReference:
              columnCounter: 5407fbdd-70e9-4351-b954-66dcfe6f4a45
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(10,0)
            description: Unique identifier (code) for a skill.
            hashColumns: []
            hashDetails: null
            name: D_SKILLS_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: ""
          - columnReference:
              columnCounter: 087739a4-e1fd-453c-a85e-abe217ce66e0
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: VARCHAR(20)
            description: ""
            hashColumns: []
            hashDetails: null
            name: FORECAST_PERIOD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3b5ab9d8-45cb-48b0-a6f1-96dbbd115532
                    stepCounter: 1822377e-5830-4840-b644-27f44f05ca98
                transform: |-
                  CASE 
                      WHEN L_BCS_Rplan.C_FCSTPRD > CURRENT_DATE+10
                      THEN 'T+5'
                      ELSE 'T+1'
                  END
          - columnReference:
              columnCounter: 0a75f983-2ea2-4e5e-9cf4-50b9b8bf0880
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: VARCHAR(20)
            description: ""
            hashColumns: []
            hashDetails: null
            name: FORECAST_TYPE
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "'Skill Service Level'"
          - columnReference:
              columnCounter: 27ff2f3f-9868-444f-b0ab-e6f33f5ddbb0
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: FORECAST_DT
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: Current_date
          - columnReference:
              columnCounter: 21e0826f-263d-4de5-b171-914345a8df0c
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_TOTAL_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: df275782-253a-451b-b7b9-3eb73ac8d9f6
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_DIRECT_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: 183ff131-ac46-461a-b3ef-eabb9a4066ec
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_INDIRECT_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: 415a5026-e948-45a3-bbbc-0fc09ef70441
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_LEAVE_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: f2a61482-162a-43e2-9c9f-d9fc0dfe47f9
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_ILLNESS_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: 9b7eea8f-924e-493a-81b3-ef997fe2b088
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_SHORT_ILLNESS_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: e8ac71da-3e46-4a38-bf60-8626399053f0
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_LONG_ILLNESS_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: 070426fa-82b5-462a-a4cd-137bec09e278
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_COACHING_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: 5cc0b1f8-1a70-4e8c-8e71-09a34bfb9ad6
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_BREAK_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: 4efc1eea-2674-4028-9571-4023ae5317a5
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_TRAINING_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: 1711bf5f-737c-438a-b2d4-665d920041ed
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_OTHER_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: 9d03f4af-b3f9-409a-acd0-72ede56980bf
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_PREGNANCY_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: 6db423a3-451c-4fb2-9884-c700957d1185
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_INFLOW_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: dfcbe074-9d84-4610-befd-09e3be13c290
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_OPEN_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: 96104d26-6808-4aba-9ec6-36dec7099c81
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_OPEN_THUIS_HOURS
            nullable: true
            sourceColumnReferences:
              - columnReferences: []
                transform: "0"
          - columnReference:
              columnCounter: 94e7f722-ced5-4e66-9e96-069b7225a876
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: Dummy hours
            hashColumns: []
            hashDetails: null
            name: MSR_AHT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ca4e9e3a-0816-4504-8d68-fe1f3285de02
                    stepCounter: 1822377e-5830-4840-b644-27f44f05ca98
                transform: |2-
                   CAST(SUBSTR(L_BCS_Rplan.C_REVAHT, 1,4) AS Integer)*24*60*60
                            + CAST(SUBSTR(L_BCS_Rplan.C_REVAHT, 6,2) AS Integer)*60*60
                            + CAST(SUBSTR(L_BCS_Rplan.C_REVAHT, 9,2) AS Integer)*60
                            + CAST(SUBSTR(L_BCS_Rplan.C_REVAHT,12,2) AS Integer)
          - columnReference:
              columnCounter: b8544893-74d8-4e1a-b636-1ab64c91c528
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MSR_OFFERED_COUNT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: eb97417a-e233-49d6-84d3-7f91d66b878e
                    stepCounter: 1822377e-5830-4840-b644-27f44f05ca98
                transform: ""
          - columnReference:
              columnCounter: 9a01d3ba-7c15-42e3-98b4-912b77c891e2
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MSR_ANSWERED_COUNT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ab222cc1-2729-43f5-8315-70f625db2d12
                    stepCounter: 1822377e-5830-4840-b644-27f44f05ca98
                transform: ""
          - columnReference:
              columnCounter: e1ba1db8-df9e-476c-9a9a-1f14d3ab78e0
              stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
            dataType: NUMBER(8,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: MSR_MAX_OCCUPANCY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9bcb1564-3eea-4095-8890-ad81dacd9aec
                    stepCounter: 1822377e-5830-4840-b644-27f44f05ca98
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE
                nodeName: L_BCS_RENTITY
              - locationName: SOURCE
                nodeName: L_BCS_RPLAN
              - locationName: TARGET
                nodeName: D_SKILLS
            join:
              joinCondition: |-
                FROM {{ ref('SOURCE', 'L_BCS_RPLAN') }} "L_BCS_RPLAN"
                JOIN {{ ref('SOURCE', 'L_BCS_RENTITY') }} "L_BCS_RENTITY" 
                  ON L_BCS_RENTITY.C_OID = L_BCS_RPLAN.C_CT
                LEFT OUTER JOIN  {{ ref('TARGET', 'D_SKILLS') }} D_SKILLS
                  ON L_BCS_RENTITY.C_ID = D_SKILLS.SKILL
                 AND L_BCS_RPLAN.C_FCSTPRD BETWEEN D_SKILLS.VALID_FROM AND D_SKILLS.VALID_TO
                WHERE L_BCS_RPLAN.C_FCSTPRD BETWEEN CURRENT_DATE + 7 - DAYOFWEEK(CURRENT_DATE)+2
                                                AND CURRENT_DATE + 7 - DAYOFWEEK(CURRENT_DATE)+2+6
                   OR L_BCS_RPLAN.C_FCSTPRD BETWEEN CURRENT_DATE +35 - DAYOFWEEK(CURRENT_DATE)+2
                                                AND CURRENT_DATE +35 - DAYOFWEEK(CURRENT_DATE)+2+6
                      ;
            name: S_EFF_AGENTFORECAST
            noLinkRefs: []
      name: S_EFF_AGENTFORECAST
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 7777512c-62c7-4d25-9783-bf7a2e436c39
