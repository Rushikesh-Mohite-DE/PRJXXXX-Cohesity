steps:
  STAGE_DATE_SF-06ea773d-617a-47f9-bea9-731a93fd1efb:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: |-
          INSERT INTO {{ ref('STAGE', 'STAGE_DATE_SF') }}
                ( DIM_DATE_KEY
            , CALENDAR_DATE
            , CAL_DAY_IN_WEEK
            , CAL_DAY_IN_WEEK_NO
            , CAL_DAY_IN_MONTH
            , CAL_DAY_IN_YEAR
            , CAL_WEEK_IN_YEAR
            , CAL_MONTH_NO
            , CAL_MONTH
            , CAL_MONTH_NAME
            , CAL_QUARTER_NO
            , CAL_QUARTER
            , CAL_YEAR
            , FINANCIAL_DATE
            , FIN_DAY_IN_WEEK
            , FIN_DAY_IN_WEEK_NO
            , FIN_DAY_IN_MONTH
            , FIN_DAY_IN_YEAR
            , FIN_WEEK_IN_MONTH
            , FIN_WEEK_IN_YEAR
            , FIN_MONTH_NO
            , FIN_MONTH
            , FIN_MONTH_NAME
            , FIN_PERIOD
            , FIN_QUARTER_NO
            , FIN_QUARTER
            , FIN_YEAR
            , CURRENT_CAL_DAY
            , CURRENT_CAL_WEEK
            , CURRENT_CAL_YEAR
            , CURRENT_CAL_MONTH
            , CURRENT_CAL_MTD
            , CURRENT_CAL_YTD
            , MOVING_CAL_YEAR
            , CURRENT_FIN_DAY
            , CURRENT_FIN_WEEK
            , CURRENT_FIN_MONTH
            , CURRENT_FIN_QUARTER
            , CURRENT_FIN_YEAR
            , CURRENT_FIN_MTD
            , CURRENT_FIN_YTD
            , MOVING_FIN_QUARTER
            , MOVING_FIN_YEAR
            , WEEK_DAY_FLAG
            , WEEK_END_FLAG
            , HOLIDAY_FLAG
            , HOLIDAY_DESC
            , TRADING_DAY_FLAG
            , TRADING_DAYS_IN_MTH
            , TRADING_DAYS_SO_FAR
            , DSS_UPDATE_TIME
                )
                SELECT TO_NUMBER(TO_CHAR(calendar_date, 'YYYYMMDD'), '99999999') AS DIM_DATE_KEY
                 , calendar_date AS CALENDAR_DATE
                 , TO_CHAR(calendar_date, 'Dy') AS CAL_DAY_IN_WEEK
                 , TO_NUMBER(TO_CHAR(DATE_PART('dw', calendar_date)), '9')+1 AS CAL_DAY_IN_WEEK_NO
                 , TO_NUMBER(TO_CHAR(calendar_date, 'DD'), '99') AS CAL_DAY_IN_MONTH
                 , TO_NUMBER(TO_CHAR(DATE_PART('DOY',calendar_date)), '999') AS CAL_DAY_IN_YEAR
                 , TO_NUMBER(TO_CHAR(DATE_PART('WK', calendar_date)), '99') AS CAL_WEEK_IN_YEAR
                 , TO_NUMBER(TO_CHAR(calendar_date, 'MM'), '99') AS CAL_MONTH_NO
                 , TO_NUMBER(TO_CHAR(calendar_date, 'YYYYMM'), '999999') AS CAL_MONTH
                 , TO_CHAR(calendar_date, 'Mon') AS CAL_MONTH_NAME
                 , TO_NUMBER(TO_CHAR(DATE_PART('Q',calendar_date)), '9') AS CAL_QUARTER_NO
                 , TO_NUMBER(TO_CHAR(calendar_date, 'YYYY') || '0' || TO_CHAR(DATE_PART('Q',calendar_date)), '999999') AS CAL_QUARTER
                 , TO_NUMBER(TO_CHAR(calendar_date, 'YYYY'), '9999') AS CAL_YEAR
                 , financial_date AS FINANCIAL_DATE
                 , TO_CHAR(financial_date, 'Dy') AS FIN_DAY_IN_WEEK
                 , TO_NUMBER(TO_CHAR(DATE_PART('dw', financial_date)), '9')+1 AS FIN_DAY_IN_WEEK_NO
                 , TO_NUMBER(TO_CHAR(financial_date, 'DD'), '99') AS FIN_DAY_IN_MONTH
                 , TO_NUMBER(TO_CHAR(DATE_PART('DOY',financial_date)), '999') AS FIN_DAY_IN_YEAR
                 , ROW_NUMBER() OVER (PARTITION BY TO_NUMBER(TO_CHAR(financial_date, 'YYYYMM'), '999999') ORDER BY TO_NUMBER(TO_CHAR(DATE_PART('WK', financial_date)), '99')) AS FIN_WEEK_IN_MONTH
                 , TO_NUMBER(TO_CHAR(DATE_PART('WK', financial_date)), '99') AS FIN_WEEK_IN_YEAR
                 , TO_NUMBER(TO_CHAR(financial_date, 'MM'), '99') AS FIN_MONTH_NO
                 , TO_NUMBER(TO_CHAR(financial_date, 'YYYYMM'), '999999') AS FIN_MONTH
                 , TO_CHAR(calendar_date, 'Mon') AS FIN_MONTH_NAME
                 , '(' || TRIM(TO_CHAR(financial_date, 'YYYY')) || '-' ||
                                 TRIM(CAST(TO_NUMBER(TO_CHAR(financial_date, 'MM'),'99') AS VARCHAR(2))) || ')' || TO_CHAR(calendar_date, 'Mon') ||
                                 '-' || TRIM(TO_CHAR(calendar_date, 'YYYY')) AS FIN_PERIOD
                 , TO_NUMBER(TO_CHAR(DATE_PART('Q',financial_date)), '9') AS FIN_QUARTER_NO
                 , TO_NUMBER(TO_CHAR(financial_date, 'YYYY') || '0' || TO_CHAR(DATE_PART('Q',financial_date)), '999999') AS FIN_QUARTER
                 , TO_NUMBER(TO_CHAR(financial_date, 'YYYY'), '9999') AS FIN_YEAR
                 , 'No' AS CURRENT_CAL_DAY
                 , 'No' AS CURRENT_CAL_WEEK
                 , 'No' AS CURRENT_CAL_YEAR
                 , 'No' AS CURRENT_CAL_MONTH
                 , 'No' AS CURRENT_CAL_MTD
                 , 'No' AS CURRENT_CAL_YTD
                 , 'No' AS MOVING_CAL_YEAR
                 , 'No' AS CURRENT_FIN_DAY
                 , 'No' AS CURRENT_FIN_WEEK
                 , 'No' AS CURRENT_FIN_MONTH
                 , 'No' AS CURRENT_FIN_QUARTER
                 , 'No' AS CURRENT_FIN_YEAR
                 , 'No' AS CURRENT_FIN_MTD
                 , 'No' AS CURRENT_FIN_YTD
                 , 'No' AS MOVING_FIN_QUARTER
                 , 'No' AS MOVING_FIN_YEAR
                 , CASE WHEN TO_CHAR(calendar_date, 'Dy') IN ('Sat','Sun') THEN 'N' ELSE 'Y' END AS WEEK_DAY_FLAG
                 , CASE WHEN TO_CHAR(calendar_date, 'Dy') IN ('Sat','Sun') THEN 'Y' ELSE 'N' END AS WEEK_END_FLAG
                 , CAST('' AS VARCHAR(64)) AS HOLIDAY_FLAG
                 , CAST('N' AS CHAR(1)) AS HOLIDAY_DESC
                 , CASE WHEN TO_CHAR(calendar_date, 'Dy') NOT IN ('Sat','Sun') AND 'N' = 'N' THEN 'Y' ELSE 'N' END AS TRADING_DAY_FLAG
                 , 0 AS TRADING_DAYS_IN_MTH
                 , 0 AS TRADING_DAYS_SO_FAR
                 , CAST(CURRENT_TIMESTAMP AS TIMESTAMP) AS DSS_UPDATE_TIME
            FROM ( SELECT DATEADD(DAY,CAST(d1.digit*10000 + d2.digit*1000 + d3.digit*100 +d4.digit*10 +d5.digit AS INTEGER)-10001,CAST(CURRENT_DATE AS DATE)) AS Calendar_Date
                        , DATEADD(DAY,CAST(d1.digit*10000 + d2.digit*1000 + d3.digit*100 +d4.digit*10 +d5.digit AS INTEGER)-10001,CAST(CURRENT_DATE AS DATE)) AS Financial_Date
                   FROM
                   ( SELECT '1' as digit UNION SELECT '2' UNION SELECT '3'
                        UNION SELECT '4' UNION SELECT '5' UNION SELECT '6'
                        UNION SELECT '7' UNION SELECT '8' UNION SELECT '9' 
                        UNION SELECT '0') d1
                   CROSS JOIN
                   ( SELECT '1' as digit UNION SELECT '2' UNION SELECT '3'
                        UNION SELECT '4' UNION SELECT '5' UNION SELECT '6'
                        UNION SELECT '7' UNION SELECT '8' UNION SELECT '9' 
                        UNION SELECT '0') d2
                   CROSS JOIN
                   ( SELECT '1' as digit UNION SELECT '2' UNION SELECT '3'
                        UNION SELECT '4' UNION SELECT '5' UNION SELECT '6'
                        UNION SELECT '7' UNION SELECT '8' UNION SELECT '9' 
                        UNION SELECT '0') d3
                   CROSS JOIN
                   ( SELECT '1' as digit UNION SELECT '2' UNION SELECT '3'
                        UNION SELECT '4' UNION SELECT '5' UNION SELECT '6'
                        UNION SELECT '7' UNION SELECT '8' UNION SELECT '9' 
                        UNION SELECT '0') d4
                   CROSS JOIN
                   ( SELECT '1' as digit UNION SELECT '2' UNION SELECT '3'
                        UNION SELECT '4' UNION SELECT '5' UNION SELECT '6'
                        UNION SELECT '7' UNION SELECT '8' UNION SELECT '9' 
                        UNION SELECT '0') d5
                   WHERE CAST(d1.digit*10000 + d2.digit*1000 + d3.digit*100 +d4.digit*10 +d5.digit AS INTEGER) <=20000
                 )
                ;
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: STAGE
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 8c416568-04c7-448d-846e-3b6dd01a022b
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: stage_date_rs.calendar_date=dim_date.calendar_date
            hashColumns: []
            hashDetails: null
            name: DIM_DATE_KEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 518e6a1d-bbda-4f6f-ba30-b83f9f3091bb
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 16b143c4-5a4b-44cc-afa8-71c26180433b
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: TIMESTAMP_NTZ(9)
            description: The calendar date for this row.
            hashColumns: []
            hashDetails: null
            name: CALENDAR_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f3845e86-ce49-407c-85bd-f22c1f11575f
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: c87994d9-148d-4d05-a4dc-2f0eb2b44b5a
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(3)
            description: "The day in the week. Format DDD. Example: mon, tue, wed."
            hashColumns: []
            hashDetails: null
            name: CAL_DAY_IN_WEEK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b70c9d06-3cb7-44fd-8f9f-f2c16e6f8b30
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: c3e399c1-b1ed-443f-a874-0e3039fab952
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: The day number in the week. 1-7 where Sunday is day 1.
            hashColumns: []
            hashDetails: null
            name: CAL_DAY_IN_WEEK_NO
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 37ca28ab-56f1-4d17-a811-764d99f240b7
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: bf22138f-8c6d-42e2-a73b-8541f038059c
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: The day in the month 1-31.
            hashColumns: []
            hashDetails: null
            name: CAL_DAY_IN_MONTH
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c01a80bd-b603-4c83-9a1e-dd2ce3acc0d5
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 3cebd4c2-8134-4fe4-b671-359efcbaa812
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: The day in the year 1-366.
            hashColumns: []
            hashDetails: null
            name: CAL_DAY_IN_YEAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d49bb289-790a-44b0-ad0f-c40b044f118e
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 331b66e9-e977-4fe9-a77d-bf97cf0a6030
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: The week in the year 0-53.
            hashColumns: []
            hashDetails: null
            name: CAL_WEEK_IN_YEAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f375e741-5d4d-4cb6-884d-6a015dd0c65a
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 165a85b4-b18a-4506-a791-8fc471b2b436
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: The calendar month number 1-12.
            hashColumns: []
            hashDetails: null
            name: CAL_MONTH_NO
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7c08ed2a-121f-4ff9-9785-11b5da85f93c
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 7ced259f-473a-4a74-9add-cc032040f611
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: "The calendar month representation. Format YYYYMM. Example: 200206."
            hashColumns: []
            hashDetails: null
            name: CAL_MONTH
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1c13c087-a0c9-4413-a6c9-18579f4cf8b6
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: d48b78ac-53c6-4366-b1f8-7aaf1f4a6857
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(7)
            description: "The calendar month name. Format MON. Examples: jan, feb, mar."
            hashColumns: []
            hashDetails: null
            name: CAL_MONTH_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 07897fc3-5b85-442d-a580-d876ef82f9eb
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: d47b268d-d1de-4d27-861e-1570706a0856
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: The calendar quarter number 1-4.
            hashColumns: []
            hashDetails: null
            name: CAL_QUARTER_NO
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 03c81cb7-3f04-43e6-8d89-19eed3c262d1
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: d8b2f7b6-7a91-41b3-88ff-bb658eb43ff8
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: The calendar quarter representation. Format YYYYQQ. Example 200204.
            hashColumns: []
            hashDetails: null
            name: CAL_QUARTER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6aeec614-7d72-4621-8736-ce159ef55c14
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: e9779f54-76c7-4019-a84c-e504e8d46492
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: The calendar year. Format YYYY
            hashColumns: []
            hashDetails: null
            name: CAL_YEAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 762a3332-e1ee-4bc1-ad38-ccd3f97dcfd8
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 94013047-fcdd-498a-ae44-0d844ab542af
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: TIMESTAMP_NTZ(9)
            description: The financial date. Same as calendar date.
            hashColumns: []
            hashDetails: null
            name: FINANCIAL_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c2269cfe-8b42-4c3c-80ba-c526c091aab3
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: b2bc3a99-0e7f-458b-819b-c942884e2dc9
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(3)
            description: "The financial day in the week. Format DDD. Example: mon,tue,wed."
            hashColumns: []
            hashDetails: null
            name: FIN_DAY_IN_WEEK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 97c241d5-e571-44b5-a42a-8c95b4ecae47
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 259e2f9a-be21-466d-9bc5-83be5d6edbfd
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: Day number in the current financial week.
            hashColumns: []
            hashDetails: null
            name: FIN_DAY_IN_WEEK_NO
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3f6f5b96-fb52-4c9c-9ff5-c7c6101c32b9
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 8da3be42-e482-4643-b6e7-1775968ac244
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: Financial day in the month. Normally the same as calendar day in the month, unless the financial period starts mid calendar month.
            hashColumns: []
            hashDetails: null
            name: FIN_DAY_IN_MONTH
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 840d8950-015f-4f4b-8fb5-5e72c7ceb741
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 80664775-19fd-405d-acaa-46843f956d89
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: Financial day in the year. Number of days since the start of the financial year.
            hashColumns: []
            hashDetails: null
            name: FIN_DAY_IN_YEAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 633ec67f-ff23-4a5f-925d-78f1a5b76ab5
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: f2176bbd-116e-438c-bcaf-c1de1da14c7c
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: Financial week in the financial month.
            hashColumns: []
            hashDetails: null
            name: FIN_WEEK_IN_MONTH
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2ee77eb2-c363-4a26-85d2-7ec8b7a99a44
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 60c68ca9-9692-4e31-8a17-96d5edf6e3c8
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: Financial week in the financial year. Number of weeks since the start of the financial year
            hashColumns: []
            hashDetails: null
            name: FIN_WEEK_IN_YEAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 726d7c29-2cf7-40af-9f8a-aa8f27d3c9b9
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: d5719215-f651-4274-ad82-ac2f73357446
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: "Financial month number. Format MM. Examples: 1,2,3."
            hashColumns: []
            hashDetails: null
            name: FIN_MONTH_NO
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ef363b51-a5ef-4054-81bc-556b7d78625e
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 33bb611a-2322-40ab-9343-781d92e8f645
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: "Financial month representation. Fromat YYYYMM. Examples: 200101, 200102."
            hashColumns: []
            hashDetails: null
            name: FIN_MONTH
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6a4b2d62-b9d2-4c4a-9a87-2b6ffe7b0311
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: b65fc892-4648-4318-9b1f-2fe27a7031cf
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(7)
            description: "Financial month. Format MON. Examples: jan, feb, mar."
            hashColumns: []
            hashDetails: null
            name: FIN_MONTH_NAME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c36cabd3-ba95-4d07-9cf9-2ebd19210667
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: c7ae2091-62fb-41d2-8d6e-4a922a30ba75
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(20)
            description: "Financial period. Format (YYYY-MM) MON-YYYY. Example: (2001-02) Feb-2002."
            hashColumns: []
            hashDetails: null
            name: FIN_PERIOD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7a2c80a8-87a9-4054-a2bf-7fd70a908c5d
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 8c6e2780-72e4-4a62-9f59-69867d9bfc38
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: Financial quarter number (1-4).
            hashColumns: []
            hashDetails: null
            name: FIN_QUARTER_NO
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c3ddb7ac-8431-4b67-b6e3-5898dc912122
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 513ebcbd-fe09-4312-b412-97a520ac781a
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: "Financial quarter representation. Format YYYYQQ. Example: 198901."
            hashColumns: []
            hashDetails: null
            name: FIN_QUARTER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2f1048ea-9927-402d-b77b-3fb81e411764
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: d61818fe-6134-4ce1-abf7-55b37ad49b35
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: Financial year. Format YYYY.
            hashColumns: []
            hashDetails: null
            name: FIN_YEAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ad8ee1b5-f8ef-47ed-8607-5ad16ddc5d95
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 6fa01ea5-88e4-4abb-8e41-c017c7fe21fe
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate the current day. Normally set to the last day information was updated in the data warehouse.
            hashColumns: []
            hashDetails: null
            name: CURRENT_CAL_DAY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 928228f7-a156-41b9-8356-263da832eb0d
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 33c5687a-f5ce-4ad0-904f-d65321d4859f
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate the current week. Set as per current_cal_day.
            hashColumns: []
            hashDetails: null
            name: CURRENT_CAL_WEEK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d4303c6b-466d-4223-807c-9614419decfb
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 30aa0943-5ca3-4924-9e27-84b03735adcd
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate the current year. Set as per current_cal_day.
            hashColumns: []
            hashDetails: null
            name: CURRENT_CAL_YEAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 31fd068b-57db-4684-9f13-0b3e7ac03a4a
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 387d8fac-11c1-4588-92fe-bbf7b1d913ad
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate the current month. Set as per current_cal_day.
            hashColumns: []
            hashDetails: null
            name: CURRENT_CAL_MONTH
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3f206366-033f-4bea-a1c9-a4364d279dfb
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 1c0cf76e-385a-45df-b41b-84ea5bfda73c
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate days in the current month to date. Set as per current_cal_day.
            hashColumns: []
            hashDetails: null
            name: CURRENT_CAL_MTD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b0e921b9-0214-4fc0-80fc-619059856de6
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 1c86a075-7aac-45c1-bf3b-8c3fcc1aee1c
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate days in the current year to date. Set as per current_cal_day.
            hashColumns: []
            hashDetails: null
            name: CURRENT_CAL_YTD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c2f1131e-4474-41c7-89d0-8c979ebdd694
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 7c44a17a-9952-4284-a831-8d2e49e4696f
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate days that constitute a full year counting back from the current day. Set as per current_cal_day.
            hashColumns: []
            hashDetails: null
            name: MOVING_CAL_YEAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 440e49c8-cdc7-49d4-84fd-9cc9da834a50
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 560b8471-d111-4aee-b3a0-424b096aaa4a
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate the current financial day. Normally set to the last financial day information was updated in the data warehouse.
            hashColumns: []
            hashDetails: null
            name: CURRENT_FIN_DAY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6f5628ce-3ee6-4af6-85a0-a68f5ca3bbcf
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 1c6d54c4-6ff8-44dd-9ee3-534425a6ff85
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate the current financial week. Set as per current_fin_day.
            hashColumns: []
            hashDetails: null
            name: CURRENT_FIN_WEEK
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b9380495-283a-49a9-829f-699494134ca2
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 997ecd0e-a4de-4e10-9453-fc6825e54a3a
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate the current financial month. Set as per current_fin_day.
            hashColumns: []
            hashDetails: null
            name: CURRENT_FIN_MONTH
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 45bda6c2-166e-41fe-8db8-5ceb91a5956c
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 6fc37b53-0048-49a2-8db7-05da1b8236e8
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate the current financial quarter. Set as per current_fin_day.
            hashColumns: []
            hashDetails: null
            name: CURRENT_FIN_QUARTER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d5fd149d-2f08-4d54-931a-c4130343fbd9
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: c896d16e-b285-47a8-a148-fc6ceca5dcc0
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate the current financial year. Set as per current_fin_day.
            hashColumns: []
            hashDetails: null
            name: CURRENT_FIN_YEAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 67d7189e-20ab-47f0-b63c-d61a256fd0aa
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: bab806dd-7a2b-44e0-833f-31e959e3e2a0
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate days in the current financial month to date. Set as per current_fin_day.
            hashColumns: []
            hashDetails: null
            name: CURRENT_FIN_MTD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1dd66d35-ab46-44fe-8225-fe831ada64bf
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 7f3e6866-c57f-4f23-a1d2-e1f6c608e923
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate days in the current financial year to date. Set as per current_fin_day.
            hashColumns: []
            hashDetails: null
            name: CURRENT_FIN_YTD
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ff6e46b1-7f68-4cb5-93b2-aa2c1d16c6a0
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 6a2bcec0-e84f-4c01-a824-8322d41cc0f9
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate days that constitute a quarter counting back from the current financial day. Set as per current_fin_day.
            hashColumns: []
            hashDetails: null
            name: MOVING_FIN_QUARTER
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dce88d0a-7d00-4611-9e70-c7f6f174f844
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: addff691-3a64-474f-a318-2ec5c8ee0d9b
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(8)
            description: Flag to indicate days that constitute a financial year counting back from the current financial day. Set as per current_fin_day.
            hashColumns: []
            hashDetails: null
            name: MOVING_FIN_YEAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 85c08d22-f0af-4d5c-b6b6-af7dd04cee9a
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 0883c9f8-1d1f-4896-adb6-1f821b28307a
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(1)
            description: Flag to indicate if a week day Y=week day N=week end.
            hashColumns: []
            hashDetails: null
            name: WEEK_DAY_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5232d501-0530-4289-8448-cdbd55ac1747
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: aa903483-8be6-4d64-bbd8-8784fd9f70c8
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(1)
            description: Flag to indicate a week end day. Y=week end, N=week day.
            hashColumns: []
            hashDetails: null
            name: WEEK_END_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 95bf7967-e051-4557-906c-9793596701c8
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 93916a55-8aec-43ca-8863-4d1b45624e17
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(1)
            description: Flag to indicate that the day in question is a holiday. Y=holiday, N=normal.
            hashColumns: []
            hashDetails: null
            name: HOLIDAY_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 10582357-5f5e-4943-a15a-0add31027370
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: bf84fe9d-f193-4bfe-9130-187ae07ebf8f
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(64)
            description: Description of the holiday when a holiday.
            hashColumns: []
            hashDetails: null
            name: HOLIDAY_DESC
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 099f29b9-ae3d-425a-80c8-e5e501d6abab
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: d83a176c-cbec-41a4-a738-3399bd435a80
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: VARCHAR(1)
            description: Flag to indicate a trading day. Y=trading, N=non trading.
            hashColumns: []
            hashDetails: null
            name: TRADING_DAY_FLAG
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a0ade48b-43b1-45ae-b8e5-ae908b7521db
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 7e78d1bb-c0ff-40a7-ac59-21b31aff68cf
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: Number of trading days in this calendar month.
            hashColumns: []
            hashDetails: null
            name: TRADING_DAYS_IN_MTH
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1f8e117c-02b2-4632-ab50-138fd21ec6b0
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: fda6aa21-6d62-4a43-bb3a-34f4b306fe09
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: NUMBER(38,0)
            description: Number of trading days in the month so far.
            hashColumns: []
            hashDetails: null
            name: TRADING_DAYS_SO_FAR
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2d15cc70-5dce-4548-a5e5-de00b014a730
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
          - columnReference:
              columnCounter: 2ac49cc3-1bb0-4f8a-aee6-60faa003cfb0
              stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
            dataType: TIMESTAMP_NTZ(9)
            description: Date and time the row was updated in the data warehouse.
            hashColumns: []
            hashDetails: null
            name: DSS_UPDATE_TIME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 084df965-d964-4fd9-9d6a-509d67ef6a4c
                    stepCounter: 56a3f05d-85c8-47d1-9825-95c77c95df27
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              LOAD_DATE_SF: 56a3f05d-85c8-47d1-9825-95c77c95df27
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: SOURCE
                nodeName: LOAD_DATE_SF
            join:
              joinCondition: FROM {{ ref('SOURCE', 'LOAD_DATE_SF') }} "LOAD_DATE_SF"
            name: STAGE_DATE_SF
            noLinkRefs: []
      name: STAGE_DATE_SF
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 06ea773d-617a-47f9-bea9-731a93fd1efb
